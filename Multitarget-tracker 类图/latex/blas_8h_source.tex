\hypertarget{blas_8h_source}{}\doxysection{blas.\+h}
\label{blas_8h_source}\index{D:/zhr\_files/Multitarget-\/tracker-\/master/src/Detector/darknet/src/blas.h@{D:/zhr\_files/Multitarget-\/tracker-\/master/src/Detector/darknet/src/blas.h}}
\mbox{\hyperlink{blas_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef BLAS\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define BLAS\_H}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{darknet_8h}{darknet.h}}"{}}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#ifdef GPU}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{dark__cuda_8h}{dark\_cuda.h}}"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{tree_8h}{tree.h}}"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{12 \textcolor{keyword}{extern} \textcolor{stringliteral}{"{}C"{}} \{}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a342ca7301ce3569b4e709b26d0c6a824}{flatten}}(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} layers, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} forward);}
\DoxyCodeLine{15 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a50faafc66cb2a46626f678e7c23b31a4}{pm}}(\textcolor{keywordtype}{int} M, \textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} *A);}
\DoxyCodeLine{16 \textcolor{keywordtype}{float} *\mbox{\hyperlink{blas_8h_a838e03f82a5b4e5e97b1ab0b660190a2}{random\_matrix}}(\textcolor{keywordtype}{int} rows, \textcolor{keywordtype}{int} cols);}
\DoxyCodeLine{17 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_abec5c296a1f7f8fb79e08ca2c1ab8c53}{time\_random\_matrix}}(\textcolor{keywordtype}{int} TA, \textcolor{keywordtype}{int} TB, \textcolor{keywordtype}{int} m, \textcolor{keywordtype}{int} k, \textcolor{keywordtype}{int} n);}
\DoxyCodeLine{18 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a35a86f53b12419497b789d1b115ca244}{reorg\_cpu}}(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacenvinfer1_abbfdeb9b425ae9b70088a3d288670867}{w}}, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} stride, \textcolor{keywordtype}{int} forward, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ad4152e1ba8b8c9d4f55dca4f77fa369d}{test\_blas}}();}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_aca992f6ed5cd6b7abca80bca89df397f}{const\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{23 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ac83fbd0b7a61cefc93f82a5867f837b4}{constrain\_ongpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{24 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ad51d7f1dc92c4351a5dcde2d515dd7fb}{constrain\_min\_max\_ongpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} \mbox{\hyperlink{namespacesse_ae37d37103fbc61e6e37cc9317bf7b44c}{MIN}}, \textcolor{keywordtype}{float} MAX, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{25 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a16c351b80490408aa433f16fa6e5bf40}{pow\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} *Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{26 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a265d9895cb0bd21d1e87aa1285f08914}{mul\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} *Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a1af2064b6d091c8bf5565327745534fc}{axpy\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} *Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{29 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a22f6b03dd54e2d4b249e53a0ca14434c}{copy\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} *Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{30 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a34c9f6d7710be70c85c343b9840981d8}{scal\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{31 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ab6edb746750d429c886cbe9b8c1421a0}{scal\_add\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} BETA, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{32 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a0e56f560dd08e165d6b5439ce93c7859}{fill\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{33 \textcolor{keywordtype}{float} \mbox{\hyperlink{blas_8h_a77e3437c6b4b2145550ee11d13634afc}{dot\_cpu}}(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} *Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{34 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_acb03f4da351568a66e755ad2962ffbb7}{test\_gpu\_blas}}();}
\DoxyCodeLine{35 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a53bd02f1fc7a910986ff52f1a572ea35}{shortcut\_cpu}}(\textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} w1, \textcolor{keywordtype}{int} h1, \textcolor{keywordtype}{int} c1, \textcolor{keywordtype}{float} *add, \textcolor{keywordtype}{int} w2, \textcolor{keywordtype}{int} h2, \textcolor{keywordtype}{int} c2, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{36 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a7d78ef642aa0ffa4cd1b7b698afdec88}{shortcut\_multilayer\_cpu}}(\textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} src\_outputs, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} *outputs\_of\_layers, \textcolor{keywordtype}{float} **layers\_output, \textcolor{keywordtype}{float} *out, \textcolor{keywordtype}{float} *in, \textcolor{keywordtype}{float} *weights, \textcolor{keywordtype}{int} nweights, \mbox{\hyperlink{darknet_8h_a4e81c0088b04bf77fe4fb1b96456d8ee}{WEIGHTS\_NORMALIZATION\_T}} weights\_normalization);}
\DoxyCodeLine{37 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a1ae5ade6b6a5b83caec9d07669f42de0}{backward\_shortcut\_multilayer\_cpu}}(\textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} src\_outputs, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} *outputs\_of\_layers,}
\DoxyCodeLine{38     \textcolor{keywordtype}{float} **layers\_delta, \textcolor{keywordtype}{float} *delta\_out, \textcolor{keywordtype}{float} *delta\_in, \textcolor{keywordtype}{float} *weights, \textcolor{keywordtype}{float} *weight\_updates, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{float} *in, \textcolor{keywordtype}{float} **layers\_output, \mbox{\hyperlink{darknet_8h_a4e81c0088b04bf77fe4fb1b96456d8ee}{WEIGHTS\_NORMALIZATION\_T}} weights\_normalization);}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_aa9b8a32d8aae40aa9a7834e58e09974f}{mean\_cpu}}(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *mean);}
\DoxyCodeLine{41 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a0b814616350ba7a38fc885e0497011a7}{variance\_cpu}}(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *variance);}
\DoxyCodeLine{42 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a0cd979e9fd13f2ef6e56c6aa50c9a92c}{normalize\_cpu}}(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial);}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ad6cf2da6713f5eb405eb21cb5bfe8dc9}{add\_bias}}(\textcolor{keywordtype}{float} *output, \textcolor{keywordtype}{float} *biases, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size);}
\DoxyCodeLine{45 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ad2afef6b2dde26f2a1098e42f8b48e8f}{scale\_bias}}(\textcolor{keywordtype}{float} *output, \textcolor{keywordtype}{float} *scales, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size);}
\DoxyCodeLine{46 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ad294f39c089d9017cbf8614bc584409d}{backward\_scale\_cpu}}(\textcolor{keywordtype}{float} *x\_norm, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{float} *scale\_updates);}
\DoxyCodeLine{47 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a87f9e84fdeb71dfa36fcd5fc6a65f4fb}{mean\_delta\_cpu}}(\textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *mean\_delta);}
\DoxyCodeLine{48 \textcolor{keywordtype}{void}  \mbox{\hyperlink{blas_8h_a5468ae76e1f7a1cfa35cf3c974d2ef8a}{variance\_delta\_cpu}}(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *variance\_delta);}
\DoxyCodeLine{49 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a85baa02a320f2f8e6939d775c38b357c}{normalize\_delta\_cpu}}(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{float} *mean\_delta, \textcolor{keywordtype}{float} *variance\_delta, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *delta);}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a520d4b34b247df84cf9a5f632cec4c12}{smooth\_l1\_cpu}}(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} *pred, \textcolor{keywordtype}{float} *truth, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a18c9530c3574f2eadefc8d6cddf4ccb6}{error}});}
\DoxyCodeLine{52 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_afb4d0ba7eb3b84de29d4aeed84fdd514}{l2\_cpu}}(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} *pred, \textcolor{keywordtype}{float} *truth, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a18c9530c3574f2eadefc8d6cddf4ccb6}{error}});}
\DoxyCodeLine{53 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a99500a4eaf41c0cda99997fbbd72568e}{weighted\_sum\_cpu}}(\textcolor{keywordtype}{float} *a, \textcolor{keywordtype}{float} *b, \textcolor{keywordtype}{float} *s, \textcolor{keywordtype}{int} num, \textcolor{keywordtype}{float} *c);}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_aba7ba0c8c66a28197affe26d5030e1af}{softmax}}(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} temp, \textcolor{keywordtype}{float} *output, \textcolor{keywordtype}{int} stride);}
\DoxyCodeLine{56 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ae774efe95983a8776fc923479e2c4f98}{upsample\_cpu}}(\textcolor{keywordtype}{float} *in, \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacenvinfer1_abbfdeb9b425ae9b70088a3d288670867}{w}}, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} stride, \textcolor{keywordtype}{int} forward, \textcolor{keywordtype}{float} scale, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{57 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ad328f3d0648b19a98fafc221e43ed73d}{softmax\_cpu}}(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} batch\_offset, \textcolor{keywordtype}{int} groups, \textcolor{keywordtype}{int} group\_offset, \textcolor{keywordtype}{int} stride, \textcolor{keywordtype}{float} temp, \textcolor{keywordtype}{float} *output);}
\DoxyCodeLine{58 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a5e97eba8afa1a44d905455842e94ca6c}{softmax\_x\_ent\_cpu}}(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} *pred, \textcolor{keywordtype}{float} *truth, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a18c9530c3574f2eadefc8d6cddf4ccb6}{error}});}
\DoxyCodeLine{59 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_af4bb746738a32114ed04673b5181e79c}{constrain\_cpu}}(\textcolor{keywordtype}{int} size, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} *X);}
\DoxyCodeLine{60 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_ae3eafcd5cc81a09e76237bd6ef144bf7}{fix\_nan\_and\_inf\_cpu}}(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{size\_t} size);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keywordtype}{int} \mbox{\hyperlink{blas_8h_a08fafe37f10aa4eec229179a4f17c9ed}{check\_sim}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{size\_t} j, \mbox{\hyperlink{structcontrastive__params}{contrastive\_params}} *contrast\_p, \textcolor{keywordtype}{int} contrast\_p\_size);}
\DoxyCodeLine{64 \textcolor{keywordtype}{float} \mbox{\hyperlink{blas_8h_a4bf13daee12ab93df8e8e0204562e467}{find\_sim}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{size\_t} j, \mbox{\hyperlink{structcontrastive__params}{contrastive\_params}} *contrast\_p, \textcolor{keywordtype}{int} contrast\_p\_size);}
\DoxyCodeLine{65 \textcolor{keywordtype}{float} \mbox{\hyperlink{blas_8h_a471aa3bdc419b65dba083ba5c140995b}{find\_P\_constrastive}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{size\_t} j, \mbox{\hyperlink{structcontrastive__params}{contrastive\_params}} *contrast\_p, \textcolor{keywordtype}{int} contrast\_p\_size);}
\DoxyCodeLine{66 \textcolor{keywordtype}{float} \mbox{\hyperlink{blas_8h_a3c493a9df07118b24ccb4da07409108b}{P\_constrastive\_f\_det}}(\textcolor{keywordtype}{size\_t} il, \textcolor{keywordtype}{int} *labels, \textcolor{keywordtype}{float} **\mbox{\hyperlink{utils_8c_a3d99b005d0fb73033dce14d4a135d01f}{z}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size, \textcolor{keywordtype}{float} temperature, \mbox{\hyperlink{structcontrastive__params}{contrastive\_params}} *contrast\_p, \textcolor{keywordtype}{int} contrast\_p\_size);}
\DoxyCodeLine{67 \textcolor{keywordtype}{float} \mbox{\hyperlink{blas_8h_abd0beec592dd5da7369dd448ababe8b7}{P\_constrastive\_f}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{size\_t} l, \textcolor{keywordtype}{int} *labels, \textcolor{keywordtype}{float} **\mbox{\hyperlink{utils_8c_a3d99b005d0fb73033dce14d4a135d01f}{z}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size, \textcolor{keywordtype}{float} temperature, \mbox{\hyperlink{structcontrastive__params}{contrastive\_params}} *contrast\_p, \textcolor{keywordtype}{int} contrast\_p\_size);}
\DoxyCodeLine{68 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a973ce783632af254a1abafefa69975a4}{grad\_contrastive\_loss\_positive\_f}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{int} *class\_ids, \textcolor{keywordtype}{int} *labels, \textcolor{keywordtype}{size\_t} num\_of\_samples, \textcolor{keywordtype}{float} **\mbox{\hyperlink{utils_8c_a3d99b005d0fb73033dce14d4a135d01f}{z}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size, \textcolor{keywordtype}{float} temperature, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{int} wh, \mbox{\hyperlink{structcontrastive__params}{contrastive\_params}} *contrast\_p, \textcolor{keywordtype}{int} contrast\_p\_size);}
\DoxyCodeLine{69 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a8cf2c86e518b52a6c51755fec812a571}{grad\_contrastive\_loss\_negative\_f}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{int} *class\_ids, \textcolor{keywordtype}{int} *labels, \textcolor{keywordtype}{size\_t} num\_of\_samples, \textcolor{keywordtype}{float} **\mbox{\hyperlink{utils_8c_a3d99b005d0fb73033dce14d4a135d01f}{z}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size, \textcolor{keywordtype}{float} temperature, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{int} wh, \mbox{\hyperlink{structcontrastive__params}{contrastive\_params}} *contrast\_p, \textcolor{keywordtype}{int} contrast\_p\_size, \textcolor{keywordtype}{int} neg\_max);}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a5e7c90d778a87f9f5940893baf570c37}{get\_embedding}}(\textcolor{keywordtype}{float} *src, \textcolor{keywordtype}{int} src\_w, \textcolor{keywordtype}{int} src\_h, \textcolor{keywordtype}{int} src\_c, \textcolor{keywordtype}{int} embedding\_size, \textcolor{keywordtype}{int} cur\_w, \textcolor{keywordtype}{int} cur\_h, \textcolor{keywordtype}{int} cur\_n, \textcolor{keywordtype}{int} cur\_b, \textcolor{keywordtype}{float} *dst);}
\DoxyCodeLine{72 \textcolor{keywordtype}{float} \mbox{\hyperlink{blas_8h_a80f2c447445a977cb25c03ef69ca6bb8}{math\_vector\_length}}(\textcolor{keywordtype}{float} *A, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size);}
\DoxyCodeLine{73 \textcolor{keywordtype}{float} \mbox{\hyperlink{blas_8h_ab1fae4b9ce6fd2360044c4d6d6f788e9}{cosine\_similarity}}(\textcolor{keywordtype}{float} *A, \textcolor{keywordtype}{float} *B, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size);}
\DoxyCodeLine{74 \textcolor{keywordtype}{float} \mbox{\hyperlink{blas_8h_a789b720cb0f460d77aa978c902395072}{P\_constrastive}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{size\_t} l, \textcolor{keywordtype}{int} *labels, \textcolor{keywordtype}{size\_t} num\_of\_samples, \textcolor{keywordtype}{float} **\mbox{\hyperlink{utils_8c_a3d99b005d0fb73033dce14d4a135d01f}{z}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size, \textcolor{keywordtype}{float} temperature, \textcolor{keywordtype}{float} *cos\_sim, \textcolor{keywordtype}{float} *exp\_cos\_sim);}
\DoxyCodeLine{75 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a7d7b65bd3c6bede89250534ed4e85883}{grad\_contrastive\_loss\_positive}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{int} *labels, \textcolor{keywordtype}{size\_t} num\_of\_samples, \textcolor{keywordtype}{float} **\mbox{\hyperlink{utils_8c_a3d99b005d0fb73033dce14d4a135d01f}{z}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size, \textcolor{keywordtype}{float} temperature, \textcolor{keywordtype}{float} *cos\_sim, \textcolor{keywordtype}{float} *p\_constrastive, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{int} wh);}
\DoxyCodeLine{76 \textcolor{keywordtype}{void} \mbox{\hyperlink{blas_8h_a1d334b40a874ddae772954c88cf55c10}{grad\_contrastive\_loss\_negative}}(\textcolor{keywordtype}{size\_t} i, \textcolor{keywordtype}{int} *labels, \textcolor{keywordtype}{size\_t} num\_of\_samples, \textcolor{keywordtype}{float} **\mbox{\hyperlink{utils_8c_a3d99b005d0fb73033dce14d4a135d01f}{z}}, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size, \textcolor{keywordtype}{float} temperature, \textcolor{keywordtype}{float} *cos\_sim, \textcolor{keywordtype}{float} *p\_constrastive, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{int} wh);}
\DoxyCodeLine{77 }
\DoxyCodeLine{78 }
\DoxyCodeLine{79 \textcolor{preprocessor}{\#ifdef GPU}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81 \textcolor{keywordtype}{void} constrain\_weight\_updates\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} coef, \textcolor{keywordtype}{float} *weights\_gpu, \textcolor{keywordtype}{float} *weight\_updates\_gpu);}
\DoxyCodeLine{82 \textcolor{keywordtype}{void} axpy\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} * Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{83 \textcolor{keywordtype}{void} axpy\_ongpu\_offset(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} OFFX, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} * Y, \textcolor{keywordtype}{int} OFFY, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{84 \textcolor{keywordtype}{void} simple\_copy\_ongpu(\textcolor{keywordtype}{int} size, \textcolor{keywordtype}{float} *src, \textcolor{keywordtype}{float} *dst);}
\DoxyCodeLine{85 \textcolor{keywordtype}{void} memcpy\_ongpu(\textcolor{keywordtype}{void} *dst, \textcolor{keywordtype}{void} *src, \textcolor{keywordtype}{int} size\_bytes);}
\DoxyCodeLine{86 \textcolor{keywordtype}{void} copy\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} * Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{87 \textcolor{keywordtype}{void} copy\_ongpu\_offset(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} OFFX, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} * Y, \textcolor{keywordtype}{int} OFFY, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{88 \textcolor{keywordtype}{void} scal\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{89 \textcolor{keywordtype}{void} scal\_add\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} BETA, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{90 \textcolor{keywordtype}{void} supp\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{91 \textcolor{keywordtype}{void} mask\_gpu\_new\_api(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{float} mask\_num, \textcolor{keywordtype}{float} * mask, \textcolor{keywordtype}{float} val);}
\DoxyCodeLine{92 \textcolor{keywordtype}{void} mask\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{float} mask\_num, \textcolor{keywordtype}{float} * mask);}
\DoxyCodeLine{93 \textcolor{keywordtype}{void} const\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{94 \textcolor{keywordtype}{void} pow\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} *Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{95 \textcolor{keywordtype}{void} mul\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} *X, \textcolor{keywordtype}{int} INCX, \textcolor{keywordtype}{float} *Y, \textcolor{keywordtype}{int} INCY);}
\DoxyCodeLine{96 \textcolor{keywordtype}{void} fill\_ongpu(\textcolor{keywordtype}{int} N, \textcolor{keywordtype}{float} ALPHA, \textcolor{keywordtype}{float} * X, \textcolor{keywordtype}{int} INCX);}
\DoxyCodeLine{97 \textcolor{keywordtype}{void} gradient\_centralization\_gpu(\textcolor{keywordtype}{int} \mbox{\hyperlink{namespacenvinfer1_abbfdeb9b425ae9b70088a3d288670867}{w}}, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} \mbox{\hyperlink{rings_8cpp_a77369fc4d5326a16d2c603e032023528}{f}}, \textcolor{keywordtype}{float} *in);}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 \textcolor{keywordtype}{void} mean\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *mean);}
\DoxyCodeLine{100 \textcolor{keywordtype}{void} variance\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *variance);}
\DoxyCodeLine{101 \textcolor{keywordtype}{void} normalize\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial);}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \textcolor{keywordtype}{void} normalize\_delta\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{float} *mean\_delta, \textcolor{keywordtype}{float} *variance\_delta, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *delta);}
\DoxyCodeLine{104 }
\DoxyCodeLine{105 \textcolor{keywordtype}{void} fast\_mean\_delta\_gpu(\textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *mean\_delta);}
\DoxyCodeLine{106 \textcolor{keywordtype}{void} fast\_variance\_delta\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *variance\_delta);}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \textcolor{keywordtype}{void} fast\_mean\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *mean);}
\DoxyCodeLine{109 \textcolor{keywordtype}{void} fast\_variance\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{float} *variance);}
\DoxyCodeLine{110 \textcolor{keywordtype}{void} fast\_v\_cbn\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{int} minibatch\_index, \textcolor{keywordtype}{int} max\_minibatch\_index, \textcolor{keywordtype}{float} *m\_avg, \textcolor{keywordtype}{float} *v\_avg, \textcolor{keywordtype}{float} *variance,}
\DoxyCodeLine{111     \textcolor{keyword}{const} \textcolor{keywordtype}{float} alpha, \textcolor{keywordtype}{float} *rolling\_mean\_gpu, \textcolor{keywordtype}{float} *rolling\_variance\_gpu, \textcolor{keywordtype}{int} inverse\_variance, \textcolor{keywordtype}{float} epsilon);}
\DoxyCodeLine{112 \textcolor{keywordtype}{void} inverse\_variance\_ongpu(\textcolor{keywordtype}{int} size, \textcolor{keywordtype}{float} *src, \textcolor{keywordtype}{float} *dst, \textcolor{keywordtype}{float} epsilon);}
\DoxyCodeLine{113 \textcolor{keywordtype}{void} normalize\_scale\_bias\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *mean, \textcolor{keywordtype}{float} *variance, \textcolor{keywordtype}{float} *scales, \textcolor{keywordtype}{float} *biases, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} filters, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{int} inverse\_variance, \textcolor{keywordtype}{float} epsilon);}
\DoxyCodeLine{114 \textcolor{keywordtype}{void} compare\_2\_arrays\_gpu(\textcolor{keywordtype}{float} *one, \textcolor{keywordtype}{float} *two, \textcolor{keywordtype}{int} size);}
\DoxyCodeLine{115 \textcolor{keywordtype}{void} shortcut\_gpu(\textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} w1, \textcolor{keywordtype}{int} h1, \textcolor{keywordtype}{int} c1, \textcolor{keywordtype}{float} *add, \textcolor{keywordtype}{int} w2, \textcolor{keywordtype}{int} h2, \textcolor{keywordtype}{int} c2, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{116 \textcolor{keywordtype}{void} shortcut\_multilayer\_gpu(\textcolor{keywordtype}{int} src\_outputs, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} *outputs\_of\_layers\_gpu, \textcolor{keywordtype}{float} **layers\_output\_gpu, \textcolor{keywordtype}{float} *out, \textcolor{keywordtype}{float} *in, \textcolor{keywordtype}{float} *weights\_gpu, \textcolor{keywordtype}{int} nweights, \mbox{\hyperlink{darknet_8h_a4e81c0088b04bf77fe4fb1b96456d8ee}{WEIGHTS\_NORMALIZATION\_T}} weights\_normalization);}
\DoxyCodeLine{117 \textcolor{keywordtype}{void} backward\_shortcut\_multilayer\_gpu(\textcolor{keywordtype}{int} src\_outputs, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} *outputs\_of\_layers\_gpu, \textcolor{keywordtype}{float} **layers\_delta\_gpu, \textcolor{keywordtype}{float} *delta\_out, \textcolor{keywordtype}{float} *delta\_in,}
\DoxyCodeLine{118     \textcolor{keywordtype}{float} *weights, \textcolor{keywordtype}{float} *weight\_updates, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{float} *in, \textcolor{keywordtype}{float} **layers\_output, \mbox{\hyperlink{darknet_8h_a4e81c0088b04bf77fe4fb1b96456d8ee}{WEIGHTS\_NORMALIZATION\_T}} weights\_normalization);}
\DoxyCodeLine{119 \textcolor{keywordtype}{void} input\_shortcut\_gpu(\textcolor{keywordtype}{float} *in, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} w1, \textcolor{keywordtype}{int} h1, \textcolor{keywordtype}{int} c1, \textcolor{keywordtype}{float} *add, \textcolor{keywordtype}{int} w2, \textcolor{keywordtype}{int} h2, \textcolor{keywordtype}{int} c2, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{120 \textcolor{keywordtype}{void} backward\_scale\_gpu(\textcolor{keywordtype}{float} *x\_norm, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{float} *scale\_updates);}
\DoxyCodeLine{121 \textcolor{keywordtype}{void} mean\_array\_gpu(\textcolor{keywordtype}{float} *src, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{float} alpha, \textcolor{keywordtype}{float} *avg);}
\DoxyCodeLine{122 \textcolor{keywordtype}{void} scale\_bias\_gpu(\textcolor{keywordtype}{float} *output, \textcolor{keywordtype}{float} *biases, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size);}
\DoxyCodeLine{123 \textcolor{keywordtype}{void} add\_bias\_gpu(\textcolor{keywordtype}{float} *output, \textcolor{keywordtype}{float} *biases, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size);}
\DoxyCodeLine{124 \textcolor{keywordtype}{void} backward\_bias\_gpu(\textcolor{keywordtype}{float} *bias\_updates, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size);}
\DoxyCodeLine{125 }
\DoxyCodeLine{126 \textcolor{keywordtype}{void} softmax\_x\_ent\_gpu(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} *pred, \textcolor{keywordtype}{float} *truth, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a18c9530c3574f2eadefc8d6cddf4ccb6}{error}});}
\DoxyCodeLine{127 \textcolor{keywordtype}{void} smooth\_l1\_gpu(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} *pred, \textcolor{keywordtype}{float} *truth, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a18c9530c3574f2eadefc8d6cddf4ccb6}{error}});}
\DoxyCodeLine{128 \textcolor{keywordtype}{void} l2\_gpu(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} *pred, \textcolor{keywordtype}{float} *truth, \textcolor{keywordtype}{float} *delta, \textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a18c9530c3574f2eadefc8d6cddf4ccb6}{error}});}
\DoxyCodeLine{129 \textcolor{keywordtype}{void} weighted\_delta\_gpu(\textcolor{keywordtype}{float} *a, \textcolor{keywordtype}{float} *b, \textcolor{keywordtype}{float} *s, \textcolor{keywordtype}{float} *da, \textcolor{keywordtype}{float} *db, \textcolor{keywordtype}{float} *ds, \textcolor{keywordtype}{int} num, \textcolor{keywordtype}{float} *dc);}
\DoxyCodeLine{130 \textcolor{keywordtype}{void} weighted\_sum\_gpu(\textcolor{keywordtype}{float} *a, \textcolor{keywordtype}{float} *b, \textcolor{keywordtype}{float} *s, \textcolor{keywordtype}{int} num, \textcolor{keywordtype}{float} *c);}
\DoxyCodeLine{131 \textcolor{keywordtype}{void} mult\_add\_into\_gpu(\textcolor{keywordtype}{int} num, \textcolor{keywordtype}{float} *a, \textcolor{keywordtype}{float} *b, \textcolor{keywordtype}{float} *c);}
\DoxyCodeLine{132 }
\DoxyCodeLine{133 \textcolor{keywordtype}{void} reorg\_ongpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacenvinfer1_abbfdeb9b425ae9b70088a3d288670867}{w}}, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} stride, \textcolor{keywordtype}{int} forward, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{134 }
\DoxyCodeLine{135 \textcolor{keywordtype}{void} softmax\_gpu\_new\_api(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} batch\_offset, \textcolor{keywordtype}{int} groups, \textcolor{keywordtype}{int} group\_offset, \textcolor{keywordtype}{int} stride, \textcolor{keywordtype}{float} temp, \textcolor{keywordtype}{float} *output);}
\DoxyCodeLine{136 \textcolor{keywordtype}{void} softmax\_gpu(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} offset, \textcolor{keywordtype}{int} groups, \textcolor{keywordtype}{float} temp, \textcolor{keywordtype}{float} *output);}
\DoxyCodeLine{137 \textcolor{keywordtype}{void} adam\_gpu(\textcolor{keywordtype}{int} n, \textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{float} *m, \textcolor{keywordtype}{float} *v, \textcolor{keywordtype}{float} B1, \textcolor{keywordtype}{float} B2, \textcolor{keywordtype}{float} rate, \textcolor{keywordtype}{float} eps, \textcolor{keywordtype}{int} t);}
\DoxyCodeLine{138 \textcolor{keywordtype}{void} adam\_update\_gpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{namespacenvinfer1_abbfdeb9b425ae9b70088a3d288670867}{w}}, \textcolor{keywordtype}{float} *\mbox{\hyperlink{namespacemkdoc_a85ae95dfe8536ee978dcacf1f5dcfe00}{d}}, \textcolor{keywordtype}{float} *m, \textcolor{keywordtype}{float} *v, \textcolor{keywordtype}{float} B1, \textcolor{keywordtype}{float} B2, \textcolor{keywordtype}{float} eps, \textcolor{keywordtype}{float} decay, \textcolor{keywordtype}{float} rate, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} t);}
\DoxyCodeLine{139 }
\DoxyCodeLine{140 \textcolor{keywordtype}{void} flatten\_ongpu(\textcolor{keywordtype}{float} *\mbox{\hyperlink{utils_8c_a676e0da0ef83bbbdf42538e54b97506b}{x}}, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{int} layers, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} forward, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 \textcolor{keywordtype}{void} upsample\_gpu(\textcolor{keywordtype}{float} *in, \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacenvinfer1_abbfdeb9b425ae9b70088a3d288670867}{w}}, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} c, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} stride, \textcolor{keywordtype}{int} forward, \textcolor{keywordtype}{float} scale, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{143 }
\DoxyCodeLine{144 \textcolor{keywordtype}{void} softmax\_tree\_gpu(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{int} spatial, \textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} stride, \textcolor{keywordtype}{float} temp, \textcolor{keywordtype}{float} *output, \mbox{\hyperlink{structtree}{tree}} hier);}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{keywordtype}{void} fix\_nan\_and\_inf(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{size\_t} size);}
\DoxyCodeLine{147 \textcolor{keywordtype}{void} reset\_nan\_and\_inf(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{size\_t} size);}
\DoxyCodeLine{148 \textcolor{keywordtype}{int} is\_nan\_or\_inf(\textcolor{keywordtype}{float} *input, \textcolor{keywordtype}{size\_t} size);}
\DoxyCodeLine{149 }
\DoxyCodeLine{150 \textcolor{keywordtype}{void} add\_3\_arrays\_activate(\textcolor{keywordtype}{float} *a1, \textcolor{keywordtype}{float} *a2, \textcolor{keywordtype}{float} *a3, \textcolor{keywordtype}{size\_t} size, \mbox{\hyperlink{darknet_8h_aea09b678fab8ab931902378cbbd79032}{ACTIVATION}} a, \textcolor{keywordtype}{float} *dst);}
\DoxyCodeLine{151 \textcolor{keywordtype}{void} sum\_of\_mults(\textcolor{keywordtype}{float} *a1, \textcolor{keywordtype}{float} *a2, \textcolor{keywordtype}{float} *b1, \textcolor{keywordtype}{float} *b2, \textcolor{keywordtype}{size\_t} size, \textcolor{keywordtype}{float} *dst);}
\DoxyCodeLine{152 \textcolor{keywordtype}{void} activate\_and\_mult(\textcolor{keywordtype}{float} *a1, \textcolor{keywordtype}{float} *a2, \textcolor{keywordtype}{size\_t} size, \mbox{\hyperlink{darknet_8h_aea09b678fab8ab931902378cbbd79032}{ACTIVATION}} a, \textcolor{keywordtype}{float} *dst);}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \textcolor{keywordtype}{void} scale\_channels\_gpu(\textcolor{keywordtype}{float} *in\_w\_h\_c, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} channel\_size, \textcolor{keywordtype}{int} batch\_size, \textcolor{keywordtype}{int} scale\_wh, \textcolor{keywordtype}{float} *scales\_c, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{155 \textcolor{keywordtype}{void} backward\_scale\_channels\_gpu(\textcolor{keywordtype}{float} *in\_w\_h\_c\_delta, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} channel\_size, \textcolor{keywordtype}{int} batch\_size, \textcolor{keywordtype}{int} scale\_wh,}
\DoxyCodeLine{156     \textcolor{keywordtype}{float} *in\_scales\_c, \textcolor{keywordtype}{float} *out\_from\_delta,}
\DoxyCodeLine{157     \textcolor{keywordtype}{float} *in\_from\_output, \textcolor{keywordtype}{float} *out\_state\_delta);}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{keywordtype}{void} backward\_sam\_gpu(\textcolor{keywordtype}{float} *in\_w\_h\_c\_delta, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} channel\_size,}
\DoxyCodeLine{161     \textcolor{keywordtype}{float} *in\_scales\_c, \textcolor{keywordtype}{float} *out\_from\_delta,}
\DoxyCodeLine{162     \textcolor{keywordtype}{float} *in\_from\_output, \textcolor{keywordtype}{float} *out\_state\_delta);}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{keywordtype}{void} sam\_gpu(\textcolor{keywordtype}{float} *in\_w\_h\_c, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} channel\_size, \textcolor{keywordtype}{float} *scales\_c, \textcolor{keywordtype}{float} *out);}
\DoxyCodeLine{165 }
\DoxyCodeLine{166 \textcolor{keywordtype}{void} smooth\_rotate\_weights\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *src\_weight\_gpu, \textcolor{keywordtype}{float} *weight\_deform\_gpu, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} angle, \textcolor{keywordtype}{int} reverse);}
\DoxyCodeLine{167 \textcolor{keywordtype}{void} stretch\_weights\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *src\_weight\_gpu, \textcolor{keywordtype}{float} *weight\_deform\_gpu, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{float} scale, \textcolor{keywordtype}{int} reverse);}
\DoxyCodeLine{168 \textcolor{keywordtype}{void} sway\_and\_flip\_weights\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *src\_weight\_gpu, \textcolor{keywordtype}{float} *weight\_deform\_gpu, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} angle, \textcolor{keywordtype}{int} reverse);}
\DoxyCodeLine{169 \textcolor{keywordtype}{void} stretch\_sway\_flip\_weights\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *src\_weight\_gpu, \textcolor{keywordtype}{float} *weight\_deform\_gpu, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} angle, \textcolor{keywordtype}{int} reverse);}
\DoxyCodeLine{170 \textcolor{keywordtype}{void} rotate\_weights\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *src\_weight\_gpu, \textcolor{keywordtype}{float} *weight\_deform\_gpu, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} reverse);}
\DoxyCodeLine{171 \textcolor{keywordtype}{void} reduce\_and\_expand\_array\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *src\_gpu, \textcolor{keywordtype}{float} *dst\_gpu, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} groups);}
\DoxyCodeLine{172 \textcolor{keywordtype}{void} expand\_array\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *src\_gpu, \textcolor{keywordtype}{float} *dst\_gpu, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} groups);}
\DoxyCodeLine{173 \textcolor{keywordtype}{void} mult\_inverse\_array\_gpu(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *src\_gpu, \textcolor{keywordtype}{float} *dst\_gpu, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{float} eps, \textcolor{keywordtype}{float} divider, \textcolor{keywordtype}{float} clip, \textcolor{keywordtype}{float} abs\_add);}
\DoxyCodeLine{174 \textcolor{keywordtype}{void} P\_constrastive\_f\_det\_gpu(\textcolor{keywordtype}{int} *labels, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} feature\_size, \textcolor{keywordtype}{float} temperature, \mbox{\hyperlink{structcontrastive__params}{contrastive\_params}} *contrast\_p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} contrast\_p\_size);}
\DoxyCodeLine{175 \textcolor{keywordtype}{void} coord\_conv\_gpu(\textcolor{keywordtype}{float} *dst, \textcolor{keywordtype}{int} size, \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacenvinfer1_abbfdeb9b425ae9b70088a3d288670867}{w}}, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} chan, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} type);}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{keywordtype}{void} forward\_implicit\_gpu(\textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{float} *weight\_gpu, \textcolor{keywordtype}{float} *output\_gpu);}
\DoxyCodeLine{178 \textcolor{keywordtype}{void} backward\_implicit\_gpu(\textcolor{keywordtype}{int} batch, \textcolor{keywordtype}{int} nweights, \textcolor{keywordtype}{float} *weight\_updates\_gpu, \textcolor{keywordtype}{float} *delta\_gpu);}
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// GPU}}
\DoxyCodeLine{181 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{182 \}}
\DoxyCodeLine{183 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{184 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
