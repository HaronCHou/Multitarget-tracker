\hypertarget{_queue_8h_source}{}\doxysection{Queue.\+h}
\label{_queue_8h_source}\index{D:/zhr\_files/Multitarget-\/tracker-\/master/async\_detector/Queue.h@{D:/zhr\_files/Multitarget-\/tracker-\/master/async\_detector/Queue.h}}
\mbox{\hyperlink{_queue_8h}{浏览该文件的文档.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <queue>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <deque>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <list>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <mutex>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <condition\_variable>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <atomic>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#define SHOW\_QUE\_LOG 0}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{18 \textcolor{keyword}{inline} std::string CurrTime\_()}
\DoxyCodeLine{19 \{}
\DoxyCodeLine{20     \textcolor{keyword}{auto} t = std::time(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{21     \textcolor{keyword}{auto} tm = *std::localtime(\&t);}
\DoxyCodeLine{22 }
\DoxyCodeLine{23     std::ostringstream oss;}
\DoxyCodeLine{24     oss << std::put\_time(\&tm, \textcolor{stringliteral}{"{}\%d.\%m.\%Y \%H:\%M:\%S:"{}});}
\DoxyCodeLine{25     \textcolor{keywordflow}{return} oss.str();}
\DoxyCodeLine{26 \}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{preprocessor}{\#define QUE\_LOG std::cout << CurrTime\_()}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#define QUE\_ERR\_LOG (std::cerr << CurrTime\_())}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{struct }\mbox{\hyperlink{struct_frame_info}{FrameInfo}};}
\DoxyCodeLine{33 \textcolor{keyword}{typedef} std::shared\_ptr<FrameInfo> \mbox{\hyperlink{_queue_8h_a957665fdf28d8e1af49404b2d37b9c54}{frame\_ptr}};}
\DoxyCodeLine{37 \textcolor{keyword}{class }\mbox{\hyperlink{class_frames_queue}{FramesQueue}}}
\DoxyCodeLine{38 \{}
\DoxyCodeLine{39 \textcolor{keyword}{private}:}
\DoxyCodeLine{40     \textcolor{keyword}{typedef} std::list<frame\_ptr> \mbox{\hyperlink{class_frames_queue_a8da89ec2c65ebc099ff306df62f8f072}{queue\_t}};}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{keyword}{public}:}
\DoxyCodeLine{46     \mbox{\hyperlink{class_frames_queue_accc3ace9fc535172b92a799c765390a7}{FramesQueue}}()}
\DoxyCodeLine{47           : \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}(),}
\DoxyCodeLine{48           \mbox{\hyperlink{class_frames_queue_adc37bdc79736b407492814067eba8676}{m\_mutex}}(),}
\DoxyCodeLine{49           \mbox{\hyperlink{class_frames_queue_a7b0bf30a7ff2767bbee8cdaf32dd3ccc}{m\_cond}}(),}
\DoxyCodeLine{50           \mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}}(false)}
\DoxyCodeLine{51     \{\}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53     \mbox{\hyperlink{class_frames_queue_ac3f3594b6d93994e2284623bd6cee6ef}{FramesQueue}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_frames_queue}{FramesQueue}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{54     \mbox{\hyperlink{class_frames_queue_a24ae5ffd3520c4150224d7090c44ec6b}{FramesQueue}}(\mbox{\hyperlink{class_frames_queue}{FramesQueue}}\&\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{55     \mbox{\hyperlink{class_frames_queue}{FramesQueue}}\& \mbox{\hyperlink{class_frames_queue_a71bd6a36d52025e37f1da4757355f979}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_frames_queue}{FramesQueue}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{56     \mbox{\hyperlink{class_frames_queue}{FramesQueue}}\& \mbox{\hyperlink{class_frames_queue_a691b6036a84b3bbde45f8928ceb9740b}{operator=}}(\mbox{\hyperlink{class_frames_queue}{FramesQueue}}\&\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{57 }
\DoxyCodeLine{59     \mbox{\hyperlink{class_frames_queue_a966e2daf73b2d816c8a59dd0520f5a14}{\string~FramesQueue}}(\textcolor{keywordtype}{void}) = \textcolor{keywordflow}{default};}
\DoxyCodeLine{60 }
\DoxyCodeLine{65     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_frames_queue_a2ddb306c7b7baf9f00c01124b00acaf5}{AddNewFrame}}(\mbox{\hyperlink{_queue_8h_a957665fdf28d8e1af49404b2d37b9c54}{frame\_ptr}} frameInfo, \textcolor{keywordtype}{size\_t} maxQueueSize)}
\DoxyCodeLine{66     \{}
\DoxyCodeLine{67 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{68         QUE\_LOG << \textcolor{stringliteral}{"{}AddNewFrame start: "{}} << frameInfo-\/>m\_dt << std::endl;}
\DoxyCodeLine{69 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{70         std::lock\_guard<std::mutex> lock(\mbox{\hyperlink{class_frames_queue_adc37bdc79736b407492814067eba8676}{m\_mutex}});}
\DoxyCodeLine{71 }
\DoxyCodeLine{72         \textcolor{keywordflow}{if} (!maxQueueSize || (maxQueueSize > 0 \&\& \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.size() < maxQueueSize))}
\DoxyCodeLine{73             \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.push\_back(frameInfo);}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{76         QUE\_LOG << \textcolor{stringliteral}{"{}AddNewFrame end: "{}} << frameInfo-\/>m\_dt << \textcolor{stringliteral}{"{}, frameInd "{}} << frameInfo-\/>m\_frameInd << \textcolor{stringliteral}{"{}, queue size "{}} << \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.size() << std::endl;}
\DoxyCodeLine{77 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79         \mbox{\hyperlink{class_frames_queue_a7b0bf30a7ff2767bbee8cdaf32dd3ccc}{m\_cond}}.notify\_all();}
\DoxyCodeLine{80     \}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{86     \textcolor{keywordtype}{void} PrintQue()}
\DoxyCodeLine{87     \{}
\DoxyCodeLine{88         QUE\_LOG << \textcolor{stringliteral}{"{}m\_que ("{}} << \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.size() << \textcolor{stringliteral}{"{}): "{}};}
\DoxyCodeLine{89         \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{90         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} it : \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}})}
\DoxyCodeLine{91         \{}
\DoxyCodeLine{92             \textcolor{keywordflow}{if} (it-\/>m\_inDetector.load() != \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}} \&\& it-\/>m\_inTracker.load() != \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}})}
\DoxyCodeLine{93                 std::cout << i << \textcolor{stringliteral}{"{} d"{}} << it-\/>m\_inDetector.load() << \textcolor{stringliteral}{"{} t"{}} << it-\/>m\_inTracker.load() << \textcolor{stringliteral}{"{}; "{}};}
\DoxyCodeLine{94             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (it-\/>m\_inDetector.load() != \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}})}
\DoxyCodeLine{95                 std::cout << i << \textcolor{stringliteral}{"{} d"{}} << it-\/>m\_inDetector.load() << \textcolor{stringliteral}{"{}; "{}};}
\DoxyCodeLine{96             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (it-\/>m\_inTracker.load() != \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}})}
\DoxyCodeLine{97                 std::cout << i << \textcolor{stringliteral}{"{} t"{}} << it-\/>m\_inTracker.load() << \textcolor{stringliteral}{"{}; "{}};}
\DoxyCodeLine{98             \textcolor{keywordflow}{else}}
\DoxyCodeLine{99                 std::cout << i << \textcolor{stringliteral}{"{}; "{}};}
\DoxyCodeLine{100 }
\DoxyCodeLine{101             ++i;}
\DoxyCodeLine{102         \}}
\DoxyCodeLine{103         std::cout << std::endl;}
\DoxyCodeLine{104     \}}
\DoxyCodeLine{105 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{110     \mbox{\hyperlink{_queue_8h_a957665fdf28d8e1af49404b2d37b9c54}{frame\_ptr}} \mbox{\hyperlink{class_frames_queue_a83ef5dce774de1fbec38dbd239312d30}{GetLastUndetectedFrame}}()}
\DoxyCodeLine{111     \{}
\DoxyCodeLine{112 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{113         QUE\_LOG << \textcolor{stringliteral}{"{}GetLastUndetectedFrame start"{}} << std::endl;}
\DoxyCodeLine{114 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{115         std::unique\_lock<std::mutex> lock(\mbox{\hyperlink{class_frames_queue_adc37bdc79736b407492814067eba8676}{m\_mutex}});}
\DoxyCodeLine{116         \textcolor{keywordflow}{while} (\mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.empty() || \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.back()-\/>m\_inDetector.load() != \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}})}
\DoxyCodeLine{117         \{}
\DoxyCodeLine{118             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}}.load())}
\DoxyCodeLine{119                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{120 }
\DoxyCodeLine{121             \mbox{\hyperlink{class_frames_queue_a7b0bf30a7ff2767bbee8cdaf32dd3ccc}{m\_cond}}.wait(lock);}
\DoxyCodeLine{122             \textcolor{comment}{//PrintQue();}}
\DoxyCodeLine{123         \}}
\DoxyCodeLine{124         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}}.load())}
\DoxyCodeLine{125         \{}
\DoxyCodeLine{126             \mbox{\hyperlink{_queue_8h_a957665fdf28d8e1af49404b2d37b9c54}{frame\_ptr}} frameInfo = \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.back();}
\DoxyCodeLine{127             assert(frameInfo-\/>m\_inDetector.load() == \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}});}
\DoxyCodeLine{128             assert(frameInfo-\/>m\_inTracker.load() == \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}});}
\DoxyCodeLine{129             frameInfo-\/>m\_inDetector.store(\mbox{\hyperlink{struct_frame_info_a164639445b356d66c94c73e863912efb}{FrameInfo::StateInProcess}});}
\DoxyCodeLine{130 }
\DoxyCodeLine{131             queue\_t::reverse\_iterator it = \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.rbegin();}
\DoxyCodeLine{132             \textcolor{keywordflow}{for} (++it; it != \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.rend(); ++it)}
\DoxyCodeLine{133             \{}
\DoxyCodeLine{134                 \textcolor{keywordflow}{if} ((*it)-\/>m\_inDetector.load() == \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}})}
\DoxyCodeLine{135                     (*it)-\/>m\_inDetector.store(\mbox{\hyperlink{struct_frame_info_a5637606d12611256d8036445da2ed0cd}{FrameInfo::StateSkipped}});}
\DoxyCodeLine{136                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{137                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{138             \}}
\DoxyCodeLine{139 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{140             PrintQue();}
\DoxyCodeLine{141             QUE\_LOG << \textcolor{stringliteral}{"{}GetLastUndetectedFrame end: "{}} << frameInfo-\/>m\_dt << \textcolor{stringliteral}{"{}, frameInd "{}} << frameInfo-\/>m\_frameInd << std::endl;}
\DoxyCodeLine{142 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{143             \textcolor{keywordflow}{return} frameInfo;}
\DoxyCodeLine{144         \}}
\DoxyCodeLine{145         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{146     \}}
\DoxyCodeLine{147 }
\DoxyCodeLine{152     queue\_t::iterator \mbox{\hyperlink{class_frames_queue_a38efb0b2d1d449b3d9b218cbc867f012}{SearchUntracked}}()}
\DoxyCodeLine{153     \{}
\DoxyCodeLine{154         queue\_t::iterator res\_it = \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.end();}
\DoxyCodeLine{155         \textcolor{keywordflow}{for} (queue\_t::iterator it = \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.begin(); it != \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.end(); ++it)}
\DoxyCodeLine{156         \{}
\DoxyCodeLine{157             \textcolor{keywordflow}{if} ((*it)-\/>m\_inDetector.load() == \mbox{\hyperlink{struct_frame_info_a164639445b356d66c94c73e863912efb}{FrameInfo::StateInProcess}} || (*it)-\/>m\_inDetector.load() == \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}})}
\DoxyCodeLine{158             \{}
\DoxyCodeLine{159                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{160             \}}
\DoxyCodeLine{161             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((*it)-\/>m\_inTracker.load() == \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}})}
\DoxyCodeLine{162             \{}
\DoxyCodeLine{163                 res\_it = it;}
\DoxyCodeLine{164                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{165             \}}
\DoxyCodeLine{166         \}}
\DoxyCodeLine{167         \textcolor{keywordflow}{return} res\_it;}
\DoxyCodeLine{168     \}}
\DoxyCodeLine{169 }
\DoxyCodeLine{174     \mbox{\hyperlink{_queue_8h_a957665fdf28d8e1af49404b2d37b9c54}{frame\_ptr}} \mbox{\hyperlink{class_frames_queue_a2de55ae38a8ea298035b41efc8910f95}{GetFirstDetectedFrame}}()}
\DoxyCodeLine{175     \{}
\DoxyCodeLine{176 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{177         QUE\_LOG << \textcolor{stringliteral}{"{}GetFirstDetectedFrame start"{}} << std::endl;}
\DoxyCodeLine{178 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{179         std::unique\_lock<std::mutex> lock(\mbox{\hyperlink{class_frames_queue_adc37bdc79736b407492814067eba8676}{m\_mutex}});}
\DoxyCodeLine{180         queue\_t::iterator it = \mbox{\hyperlink{class_frames_queue_a38efb0b2d1d449b3d9b218cbc867f012}{SearchUntracked}}();}
\DoxyCodeLine{181         \textcolor{keywordflow}{while} (it == \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.end())}
\DoxyCodeLine{182         \{}
\DoxyCodeLine{183             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}}.load())}
\DoxyCodeLine{184                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{185 }
\DoxyCodeLine{186             \mbox{\hyperlink{class_frames_queue_a7b0bf30a7ff2767bbee8cdaf32dd3ccc}{m\_cond}}.wait(lock);}
\DoxyCodeLine{187             it = \mbox{\hyperlink{class_frames_queue_a38efb0b2d1d449b3d9b218cbc867f012}{SearchUntracked}}();}
\DoxyCodeLine{188             \textcolor{comment}{//PrintQue();}}
\DoxyCodeLine{189         \}}
\DoxyCodeLine{190         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}}.load())}
\DoxyCodeLine{191         \{}
\DoxyCodeLine{192             \mbox{\hyperlink{_queue_8h_a957665fdf28d8e1af49404b2d37b9c54}{frame\_ptr}} frameInfo = *it;}
\DoxyCodeLine{193             assert(frameInfo-\/>m\_inTracker.load() == \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}});}
\DoxyCodeLine{194             assert(frameInfo-\/>m\_inDetector.load() != \mbox{\hyperlink{struct_frame_info_a164639445b356d66c94c73e863912efb}{FrameInfo::StateInProcess}} \&\& frameInfo-\/>m\_inDetector.load() != \mbox{\hyperlink{struct_frame_info_aeee132de46f4ce7f2f4a397d185bd1af}{FrameInfo::StateNotProcessed}});}
\DoxyCodeLine{195             frameInfo-\/>m\_inTracker.store(\mbox{\hyperlink{struct_frame_info_a164639445b356d66c94c73e863912efb}{FrameInfo::StateInProcess}});}
\DoxyCodeLine{196 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{197             QUE\_LOG << \textcolor{stringliteral}{"{}GetFirstDetectedFrame end: "{}} << frameInfo-\/>m\_dt << \textcolor{stringliteral}{"{}, frameInd "{}} << frameInfo-\/>m\_frameInd << std::endl;}
\DoxyCodeLine{198 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{199             \textcolor{keywordflow}{return} frameInfo;}
\DoxyCodeLine{200         \}}
\DoxyCodeLine{201         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{202     \}}
\DoxyCodeLine{203 }
\DoxyCodeLine{208     \mbox{\hyperlink{_queue_8h_a957665fdf28d8e1af49404b2d37b9c54}{frame\_ptr}} \mbox{\hyperlink{class_frames_queue_a64f40482da7f0a7fe27c7e607726c84c}{GetFirstProcessedFrame}}()}
\DoxyCodeLine{209     \{}
\DoxyCodeLine{210 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{211         QUE\_LOG << \textcolor{stringliteral}{"{}GetFirstProcessedFrame start"{}} << std::endl;}
\DoxyCodeLine{212 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{213         std::unique\_lock<std::mutex> lock(\mbox{\hyperlink{class_frames_queue_adc37bdc79736b407492814067eba8676}{m\_mutex}});}
\DoxyCodeLine{214         \textcolor{keywordflow}{while} (\mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.empty() || \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.front()-\/>m\_inTracker.load() != \mbox{\hyperlink{struct_frame_info_a48f403c1bb31b43ac90e2bae570b1376}{FrameInfo::StateCompleted}})}
\DoxyCodeLine{215         \{}
\DoxyCodeLine{216             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}}.load())}
\DoxyCodeLine{217                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{218 }
\DoxyCodeLine{219             \mbox{\hyperlink{class_frames_queue_a7b0bf30a7ff2767bbee8cdaf32dd3ccc}{m\_cond}}.wait(lock);}
\DoxyCodeLine{220             \textcolor{comment}{//PrintQue();}}
\DoxyCodeLine{221         \}}
\DoxyCodeLine{222         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}}.load())}
\DoxyCodeLine{223         \{}
\DoxyCodeLine{224             \mbox{\hyperlink{_queue_8h_a957665fdf28d8e1af49404b2d37b9c54}{frame\_ptr}} frameInfo = std::move(\mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.front());}
\DoxyCodeLine{225             \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}}.pop\_front();}
\DoxyCodeLine{226 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{227             QUE\_LOG << \textcolor{stringliteral}{"{}GetFirstProcessedFrame end: "{}} << frameInfo-\/>m\_dt << \textcolor{stringliteral}{"{}, frameInd "{}} << frameInfo-\/>m\_frameInd << std::endl;}
\DoxyCodeLine{228 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{229             \textcolor{keywordflow}{return} frameInfo;}
\DoxyCodeLine{230         \}}
\DoxyCodeLine{231         \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{232     \}}
\DoxyCodeLine{233 }
\DoxyCodeLine{237     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_frames_queue_a0220c0d42957749073f1621b89ff3dd3}{Signal}}(}
\DoxyCodeLine{238 \#\textcolor{keywordflow}{if} \mbox{\hyperlink{_queue_8h_a6042fbb81b7d9fb06897c3f247eb00ba}{SHOW\_QUE\_LOG}}}
\DoxyCodeLine{239         int64 ts}
\DoxyCodeLine{240 \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{241         int64 \textcolor{comment}{/*ts*/}}
\DoxyCodeLine{242 \#endif}
\DoxyCodeLine{243     )}
\DoxyCodeLine{244     \{}
\DoxyCodeLine{245 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{246         QUE\_LOG << \textcolor{stringliteral}{"{}Signal start:"{}} << ts << std::endl;}
\DoxyCodeLine{247 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{248         \mbox{\hyperlink{class_frames_queue_a7b0bf30a7ff2767bbee8cdaf32dd3ccc}{m\_cond}}.notify\_all();}
\DoxyCodeLine{249 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{250         QUE\_LOG << \textcolor{stringliteral}{"{}Signal end: "{}} << ts << std::endl;}
\DoxyCodeLine{251 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{252     \}}
\DoxyCodeLine{253 }
\DoxyCodeLine{254     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_frames_queue_a606b27e4858add0246bc281af7350a9d}{SetBreak}}(\textcolor{keywordtype}{bool} val)}
\DoxyCodeLine{255     \{}
\DoxyCodeLine{256 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{257         QUE\_LOG << \textcolor{stringliteral}{"{}SetBreak start:"{}} << val << std::endl;}
\DoxyCodeLine{258 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{259         \mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}} = val;}
\DoxyCodeLine{260         \mbox{\hyperlink{class_frames_queue_a0220c0d42957749073f1621b89ff3dd3}{Signal}}(0);}
\DoxyCodeLine{261 \textcolor{preprocessor}{\#if SHOW\_QUE\_LOG}}
\DoxyCodeLine{262         QUE\_LOG << \textcolor{stringliteral}{"{}SetBreak end:"{}} << val << std::endl;}
\DoxyCodeLine{263 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{264     \}}
\DoxyCodeLine{265 }
\DoxyCodeLine{266 \textcolor{keyword}{private}:}
\DoxyCodeLine{267     \mbox{\hyperlink{class_frames_queue_a8da89ec2c65ebc099ff306df62f8f072}{queue\_t}} \mbox{\hyperlink{class_frames_queue_ac5b7e35136924b0b130228f1d1fe92f3}{m\_que}};}
\DoxyCodeLine{268     \textcolor{keyword}{mutable} \mbox{\hyperlink{data_8c_a4acff8232e4aec9cd5c6dc200ac55ef3}{std::mutex}} \mbox{\hyperlink{class_frames_queue_adc37bdc79736b407492814067eba8676}{m\_mutex}};}
\DoxyCodeLine{269     std::condition\_variable \mbox{\hyperlink{class_frames_queue_a7b0bf30a7ff2767bbee8cdaf32dd3ccc}{m\_cond}};}
\DoxyCodeLine{270     std::atomic<bool> \mbox{\hyperlink{class_frames_queue_a581e23eb4e3b91492b386963d1a268ed}{m\_break}};}
\DoxyCodeLine{271 \};}

\end{DoxyCode}
